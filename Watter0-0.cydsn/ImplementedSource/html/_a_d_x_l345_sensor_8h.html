<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Watter: ADXL345Sensor.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Watter
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">A Cycling power pedal using BLE</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ADXL345Sensor.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This header includes necessary structs and functions to communicate with an ADXL345 accelerometer over I2C.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;project.h&quot;</code><br />
</div>
<p><a href="_a_d_x_l345_sensor_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_a_d_x_l345_i2_c_data.html">ADXL345I2CData</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This struct is used when getting raw data from I2C communication with ADXL345.  <a href="struct_a_d_x_l345_i2_c_data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_a_d_x_l345_data.html">ADXL345Data</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This struct is used when data is restructured from the raw I2C data struct.  <a href="struct_a_d_x_l345_data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a862ae8d5eca9d34075b31effea2bb8be"><td class="memItemLeft" align="right" valign="top"><a id="a862ae8d5eca9d34075b31effea2bb8be"></a>
typedef struct <a class="el" href="struct_a_d_x_l345_i2_c_data.html">ADXL345I2CData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_x_l345_sensor_8h.html#a862ae8d5eca9d34075b31effea2bb8be">ADXL345I2CData</a></td></tr>
<tr class="memdesc:a862ae8d5eca9d34075b31effea2bb8be"><td class="mdescLeft">&#160;</td><td class="mdescRight">This struct is used when getting raw data from I2C communication with ADXL345. <br /></td></tr>
<tr class="separator:a862ae8d5eca9d34075b31effea2bb8be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52e1fd9e671202f6e6b2ebdd3f0d7263"><td class="memItemLeft" align="right" valign="top"><a id="a52e1fd9e671202f6e6b2ebdd3f0d7263"></a>
typedef struct <a class="el" href="struct_a_d_x_l345_data.html">ADXL345Data</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_x_l345_sensor_8h.html#a52e1fd9e671202f6e6b2ebdd3f0d7263">ADXL345Data</a></td></tr>
<tr class="memdesc:a52e1fd9e671202f6e6b2ebdd3f0d7263"><td class="mdescLeft">&#160;</td><td class="mdescRight">This struct is used when data is restructured from the raw I2C data struct. <br /></td></tr>
<tr class="separator:a52e1fd9e671202f6e6b2ebdd3f0d7263"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3c9434ab097fcd5aa36bcf2349f168dc"><td class="memItemLeft" align="right" valign="top"><a id="a3c9434ab097fcd5aa36bcf2349f168dc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_x_l345_sensor_8h.html#a3c9434ab097fcd5aa36bcf2349f168dc">ADXL345Init</a> ()</td></tr>
<tr class="memdesc:a3c9434ab097fcd5aa36bcf2349f168dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialization function This function writes to a bunch of registers on the sensor, all of which is required for reading from the sensors three axises. It is also within this funciton the user is able to calibrate all of the sensors axises. <br /></td></tr>
<tr class="separator:a3c9434ab097fcd5aa36bcf2349f168dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ae619ca837b5e93cc930fec17ec29d8"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_x_l345_sensor_8h.html#a5ae619ca837b5e93cc930fec17ec29d8">deltaAxis2Deg</a> (float xData1, float yData1, float zData1, float xData2, float yData2, float zData2)</td></tr>
<tr class="memdesc:a5ae619ca837b5e93cc930fec17ec29d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the number of degrees between two accelerometer datasets.  <a href="_a_d_x_l345_sensor_8h.html#a5ae619ca837b5e93cc930fec17ec29d8">More...</a><br /></td></tr>
<tr class="separator:a5ae619ca837b5e93cc930fec17ec29d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e22aff3a9b47ba2881baef447e63b67"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_x_l345_sensor_8h.html#a8e22aff3a9b47ba2881baef447e63b67">average</a> (float rpmData)</td></tr>
<tr class="memdesc:a8e22aff3a9b47ba2881baef447e63b67"><td class="mdescLeft">&#160;</td><td class="mdescRight">A moving average filter, used to smooth out the RPM calculation.  <a href="_a_d_x_l345_sensor_8h.html#a8e22aff3a9b47ba2881baef447e63b67">More...</a><br /></td></tr>
<tr class="separator:a8e22aff3a9b47ba2881baef447e63b67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac485aea0c5ef5f3798559608dbd2c0fa"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_x_l345_sensor_8h.html#ac485aea0c5ef5f3798559608dbd2c0fa">RPM</a> (float x, float y, float z)</td></tr>
<tr class="memdesc:ac485aea0c5ef5f3798559608dbd2c0fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the revolutions pr. minute.  <a href="_a_d_x_l345_sensor_8h.html#ac485aea0c5ef5f3798559608dbd2c0fa">More...</a><br /></td></tr>
<tr class="separator:ac485aea0c5ef5f3798559608dbd2c0fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a478742601f239145356b68b768e0724e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_a_d_x_l345_data.html">ADXL345Data</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_x_l345_sensor_8h.html#a478742601f239145356b68b768e0724e">ADXL345GetData</a> ()</td></tr>
<tr class="memdesc:a478742601f239145356b68b768e0724e"><td class="mdescLeft">&#160;</td><td class="mdescRight">When called, reads from the related I2C registers and stores the meassurement in "data" variable and processes them.  <a href="_a_d_x_l345_sensor_8h.html#a478742601f239145356b68b768e0724e">More...</a><br /></td></tr>
<tr class="separator:a478742601f239145356b68b768e0724e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This header includes necessary structs and functions to communicate with an ADXL345 accelerometer over I2C. </p>
<dl class="section author"><dt>Author</dt><dd>your name (<a href="#" onclick="location.href='mai'+'lto:'+'you'+'@d'+'oma'+'in'+'.co'+'m'; return false;">you@d<span style="display: none;">.nosp@m.</span>omai<span style="display: none;">.nosp@m.</span>n.com</a>) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2020-12-13 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a478742601f239145356b68b768e0724e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a478742601f239145356b68b768e0724e">&#9670;&nbsp;</a></span>ADXL345GetData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_a_d_x_l345_data.html">ADXL345Data</a> ADXL345GetData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>When called, reads from the related I2C registers and stores the meassurement in "data" variable and processes them. </p>
<p>Is responsible for getting X, Y and Z data from the accelerometer via the I2C read functions. The function divides the read values by the sensitivity of the accelerometer (typ. 256) and also stores the processed values in data.x, data.y and data.z.</p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="struct_a_d_x_l345_data.html" title="This struct is used when data is restructured from the raw I2C data struct.">ADXL345Data</a> Returns the ADXL data struct, containing the processed data.x, data.y and data.z </dd></dl>

</div>
</div>
<a id="a8e22aff3a9b47ba2881baef447e63b67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e22aff3a9b47ba2881baef447e63b67">&#9670;&nbsp;</a></span>average()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float average </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>rpmData</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A moving average filter, used to smooth out the RPM calculation. </p>
<p>Used inside RPM function, and uses a circular buffer to store RPM values and calculate the moving average of "M" values, where "M" is the array size.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rpmData</td><td>Raw RPM value to be averaged. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>float The calculated average of "M" number of raw RPM values. </dd></dl>

</div>
</div>
<a id="a5ae619ca837b5e93cc930fec17ec29d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ae619ca837b5e93cc930fec17ec29d8">&#9670;&nbsp;</a></span>deltaAxis2Deg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float deltaAxis2Deg </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>xData1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>yData1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>zData1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>xData2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>yData2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>zData2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the number of degrees between two accelerometer datasets. </p>
<p>This function uses 3D vector math to calculate the of degrees between two accelerometer measurements. Assumes that both dataset is under the same amout of G-force, 1G from gravity, and can only calculate positive degree values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xData1</td><td>The X value of dataset #1 </td></tr>
    <tr><td class="paramname">yData1</td><td>The Y value of dataset #1 </td></tr>
    <tr><td class="paramname">zData1</td><td>The Z value of dataset #1</td></tr>
    <tr><td class="paramname">xData2</td><td>The X value of dataset #2 </td></tr>
    <tr><td class="paramname">yData2</td><td>The Y value of dataset #2 </td></tr>
    <tr><td class="paramname">zData2</td><td>The Z value of dataset #2 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>float The calculated number of degrees between dataset #1 and dataset #2 </dd></dl>

</div>
</div>
<a id="ac485aea0c5ef5f3798559608dbd2c0fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac485aea0c5ef5f3798559608dbd2c0fa">&#9670;&nbsp;</a></span>RPM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float RPM </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the revolutions pr. minute. </p>
<p>This function uses both <a class="el" href="_a_d_x_l345_sensor_8h.html#a8e22aff3a9b47ba2881baef447e63b67" title="A moving average filter, used to smooth out the RPM calculation.">average()</a> and <a class="el" href="_a_d_x_l345_sensor_8h.html#a5ae619ca837b5e93cc930fec17ec29d8" title="Calculates the number of degrees between two accelerometer datasets.">deltaAxis2Deg()</a> to return an average revolutions pr. minute. by using timed interrupt and a single measurement dataset.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>The momentary value of the X Axis. </td></tr>
    <tr><td class="paramname">y</td><td>The momentary value of the y Axis. </td></tr>
    <tr><td class="paramname">z</td><td>The momentary value of the Z Axis. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>float a average revolutions pr. minute. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
